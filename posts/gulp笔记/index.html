<!DOCTYPE html>
<html lang="en" dir=" auto">

<head><script src="/aLong/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=aLong/livereload" data-no-instant defer></script>
</head>

<body class="" id="
    top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/aLong/" accesskey="h" title="aLong blog (Alt + H)">aLong blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      gulp笔记
    </h1>
    <div class="post-meta"><span title='2019-04-22 18:08:54 +0000 UTC'>2019-04-22</span>

</div>
  </header> 
  <div class="post-content"><h3 id="gulp">gulp<a hidden class="anchor" aria-hidden="true" href="#gulp">#</a></h3>
<p>gulp.js是一个前端构建工具。</p>
<h3 id="安装">安装<a hidden class="anchor" aria-hidden="true" href="#安装">#</a></h3>
<ol>
<li>npm</li>
<li>安装全局gulp，<code>npm install -g gulp</code>。（如果没有梯子，最好安装下cnpm）
cnpm 安装 <code>npm install -g cnpm --registry=https://registry.npm.taobao.org</code>
安装完cnpm，下面所有npm操作替换cnpm 执行即可。</li>
<li>进入项目，初始化（npm init）</li>
<li>项目安装gulp，项目文件夹下，<code>npm install --save-dev gulp</code>。 (&ndash;save-dev 加入此项目依赖中，不需要可取消这个参数)</li>
<li>项目根创建gulpfile.js文件，文件内创建任务测试。</li>
</ol>
<pre tabindex="0"><code>var gulp = require(&#39;gulp&#39;);
gulp.task(&#39;default&#39;,function(){
    console.log(&#39;hello world!&#39;);
});
</code></pre><ol start="6">
<li>运行 <code>gulp</code>，可以看到默认执行，输出 hello world! 。测试成功。</li>
</ol>
<h3 id="gulp-api">gulp API<a hidden class="anchor" aria-hidden="true" href="#gulp-api">#</a></h3>
<pre><code>上面运行 gulp 执行default ，这个是gulp API。 [文档](https://www.gulpjs.com.cn/docs/api/) 
</code></pre>
<h4 id="gulp工作方式">gulp工作方式<a hidden class="anchor" aria-hidden="true" href="#gulp工作方式">#</a></h4>
<p><code>gulp.src</code> 获取文件流,通过<code>pipe</code>方法导入到插件，插件处理的流通过<code>pipe</code>方法导入 <code>gulp.dest</code>中, <code>gulp.dest</code> 输出目标文件。</p>
<ul>
<li>
<p>gulp src
<code>gulp.src(globs[, options])</code></p>
<blockquote>
<p>输出（Emits）符合所提供的匹配模式（glob）或者匹配模式的数组（array of globs）的文件。 将返回一个 Vinyl files 的 stream 它可以被 piped 到别的插件中。</p>
</blockquote>
</li>
</ul>
<p>文档这意思看着有点费劲，理解为获取文件路径。gulp通过这个方法获取到处理的文件流。</p>
<p>参数：</p>
<pre><code>globs 文件匹配模式，匹配文件路径，文件名。
类型： string array

options  额外可选参数
类型： object
额外参数需要看手册
</code></pre>
<ul>
<li>
<p>gulp.dest
<code>gulp.dest(path[, options])</code></p>
<blockquote>
<p>能被 pipe 进来，并且将会写文件。并且重新输出（emits）所有数据，因此你可以将它 pipe 到多个文件夹。如果某文件夹不存在，将会自动创建它。</p>
</blockquote>
</li>
</ul>
<p>理解为写文件，写入path路径文件。</p>
<p>参数：</p>
<pre><code>path 文件写入路径
类型：string function

options 额外可选参数
类型：object
</code></pre>
<ul>
<li>
<p>gulp.task
<code>gulp.task(name[, deps], fn)</code></p>
<blockquote>
<p>定义一个使用 Orchestrator 实现的任务（task）。</p>
</blockquote>
</li>
</ul>
<p>用来定义任务，内部使用的是Orchestrator。</p>
<p>参数：</p>
<pre><code>name 任务名字

deps 是当前任务需要的其他任务，一个数组。依赖任务，先于此任务执行。
类型：array

fn  该函数定义任务所要执行的一些操作，把任务要执行的代码写在里面。
</code></pre>
<ul>
<li>gulp.watch
<code>gulp.watch(glob[, opts], tasks)</code>
<code>gulp.watch(glob[, opts, cb])</code></li>
</ul>
<blockquote>
<p>监视文件，并且可以在文件发生改动时候做一些事情。</p>
</blockquote>
<p>参数：</p>
<pre><code>glob 文件匹配模式
类型 string array

opts 可选配置
类型 object

tasks 文件变动后执行的任务
类型 array

cb 一个函数，文件发生变化时调用的函数。
类型 function
</code></pre>
<p><em>Glob</em> 匹配模式  <a href="https://github.com/isaacs/node-glob">(node-glob）参考语法</a></p>
<pre tabindex="0"><code>匹配符                             说明
      *                               匹配文件路径中的0个或多个字符，但不会匹配路径分割符，
                                      除非分隔符出现在末尾

      **                              匹配路径的0个会多个目录 及子目录 需要单独出现，
                                      即他左右不能有其他的东西了如果出现在末尾，也能匹配文件

      ？                              匹配文件路径中的一个字符（不能匹配路径分割符/）

      [...]                           匹配方括号中 出现字符的任意一个，当方括号中第一个字符为^或!时，
                                      则表示不匹配方括号中出现字符中的任意一个，
                                      类似于js中正则表达式中的用法

      !(pattern|pattern|pattern)      匹配任何与括号中给定的任意模式都不匹配
      ？(pattern|pattern|pattern)     匹配括号中给定的任意模式0次或1次
      +(pattern|pattern|pattern)      匹配括号中的至少一次
      *(pattern|pattern|pattern)      匹配括号中给定的任意模式0次或多次
      @(pattern|pattern|pattern)      匹配括号中 给定的任意模式一次

    eg：glob 匹配
      |能匹配 a.js,x.y,abc,abc/,但不能匹配a/b.js|
      |.*   a.js,style.css,a.b,x.y
      //*.js    能匹配 a/b/c.js,x/y/z.js,不能匹配a/b.js,a/b/c/d.js
      **    能匹配 abc,a/b.js,a/b/c.js,x/y/z,x/y/z/a.b,能用来匹配所有的目录和文件
      a/**/z    能匹配 a/z,a/b/z,a/b/c/z,a/d/g/h/j/k/z
      a/**b/z   能匹配 a/b/z,a/sb/z,但不能匹配a/x/sb/z,因为只有单**单独出现才能匹配多级目录
      ?.js  能匹配 a.js,b.js,c.js
      a??   能匹配 a.b,abc,但不能匹配ab/,因为它不会匹配路径分隔符
      [xyz].js  只能匹配 x.js,y.js,z.js,不会匹配xy.js,xyz.js等,整个中括号只代表一个字符
      [^xyz].js 能匹配 a.js,b.js,c.js等,不能匹配x.js,y.js,z.js
</code></pre><p>多种匹配模式时，使用数组
<code>gulp.src(['js/*.js','css/*.css','*.html'])</code></p>
<p>数组中可以用 <code>！</code> 排除*(放在数组第一个无效)*
<code>gulp.src([*.js,'!b*.js'])</code></p>
<h3 id="编写一个任务">编写一个任务<a hidden class="anchor" aria-hidden="true" href="#编写一个任务">#</a></h3>
<p>常用到压缩，写个压缩demo。
目录，根目录下有两个文件夹，dist空文件，src目录,src/js文件夹2个文件，common.js,demo.js。
任务目标，将js目录下的.js文件，压缩合并为new.min.js。之后将合并压缩的文件保存到dist/js/。</p>
<ol>
<li>我们在初始化后的项目中，先安装所需插件，gulp-rename（重命名插件）,gulp-uglify（压缩js插件），gulp-concat（合并文件插件）。
npm install gulp-rename gulp-uglify gulp-concat &ndash;save-dev</li>
<li>编辑gulpfile.js</li>
</ol>
<pre tabindex="0"><code>   var gulp=require(&#39;gulp&#39;); 
   var  rename= require(&#39;gulp-rename&#39;);  //引入插件
   var  uglify= require(&#39;gulp-uglify&#39;);
   var  concat= require(&#39;gulp-concat&#39;);

    gulp.task(&#39;js&#39;, function(){                   //创建名为 js的任务
        return gulp.src(&#39;src/js/*.js&#39;)           //读取文件流           
        .pipe(concat())                             //合并
        .pipe(uglify())                              //压缩
        .pipe(rename({suffix: &#39;.min&#39;}))     //重命名
        .pipe(gulp.dest(&#39;dist/js/&#39;))          //输出到指定路径
      });
</code></pre><p>文件保存后，命令行执行任务： <code>gulp js</code> 。
可以看到Finshed时间，去dist目录可以看到合并压缩的文件已在里面。</p>
<h3 id="gulp插件">gulp插件<a hidden class="anchor" aria-hidden="true" href="#gulp插件">#</a></h3>
<ul>
<li>CSS压缩 gulp-minify-css</li>
<li>Js压缩 gulp-uglify</li>
<li>重命名 gulp-rename</li>
<li>文件合并 gulp-concat</li>
<li>自动加载 gulp-load-plugins</li>
<li>less编译 gulp-less</li>
<li>sass编译 gulp-sass</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/aLong/tags/gulp/">Gulp</a></li>
    </ul>
  </footer>
</article>
    </main>
    <footer>
    // ... 其他页脚内容 ...
    <a href="http://localhost:1313/aLong/index.xml">订阅RSS</a>
</footer></body>

</html>