<!DOCTYPE html>
<html lang="en" dir=" auto">

<head>
	<meta name="generator" content="Hugo 0.135.0"><script src="/aLong/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=aLong/livereload" data-no-instant defer></script>
</head>

<body class=" list" id="
    top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/aLong/" accesskey="h" title="aLong blog (Alt + H)">aLong blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main"> 

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">解决/usr/local/go/pkg/darwin_amd64/runtime/cgo.a: permission denied问题
    </h2>
  </header>
  <div class="entry-content">
    <p>最近Goland在run的时候发现一个问题 open /usr/local/go/pkg/darwin_amd64/runtime/cgo.a: permission denied
情况具体是当我run的时候有问题。debug可以。根据错误提示看到是权限的事。
解决方式 执行 sudo chown -R xxx:yyy /usr/local/go
xxx 用户名， yyy 组名
命令的目的：更改go目录的所有者用户和组。
查看用户名&amp;用户组 当前用户名 常用命令 who am i 查看当前用户名和组 ls -la
参考 https://github.com/golang/go/issues/37962
</p>
  </div>
  <footer class="entry-footer"><span title='2021-02-22 09:06:08 +0000 UTC'>2021-02-22</span></footer>
  <a class="entry-link" aria-label="post link to 解决/usr/local/go/pkg/darwin_amd64/runtime/cgo.a: permission denied问题" href="http://localhost:1313/aLong/posts/%E8%A7%A3%E5%86%B3-usr-local-go-pkg-darwin-amd64-runtime-cgo-a-permission-denied%E9%97%AE%E9%A2%98/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Grafana插件Plugin中文汉化
    </h2>
  </header>
  <div class="entry-content">
    <p>汉化三方插件 前面说过汉化Grafana的工作。目前在7.2.1上面，大部分已经完成。细节继续完善。 今天考虑在第三方插件上做一些汉化。点到插件一看全是英文感觉很突出。领导看到了也不爽啊-.-！。
找个软的捏 饼图在展示方面比较直观。Grafana上有一个插件Pie Chart 。这个现象比较少，同时在一些模版上使用中。就拿这个热热身。
具体步骤 下载项目
项目地址：piechart-panel 文件结构：
git clone git@github.com:grafana/piechart-panel.git cd piechart-panel # 进入到目录 yarn install 我直接把项目clone到grafana存放插件的位置，我的grafana是为了测试run的一个docker镜像。把插件目录挂载到本机，代码clone到目录中。
汉化工作
根据上面目录看，主要修改文件都在src里面。 IDE打开此项目，在src中修改需要编辑的文件。
图片举例，选项第一项选择图形类型。选项内容pie / donut。通过翻译我修改成了 派/甜甜圈。根据修改内容其他地方设计修改的都需要修改。我通过查询替换方式，在其他文件中修改了代码中的判断。例如上图右侧展示的文件类似。
build插件
修改完需要的内容之后，grafana是能识别到有一个插件，但没有build时候他会提示你没有build插件。就是他不认识你的项目代码。
这个怎么处理呢？看官方的文档
执行 yarn dev
# 执行结束提示，美滋滋～ ✔ Bundling plugin in dev mode ✨ Done in 4.91s. 执行完毕我们重启grafana就可以看到成果了。
对比下原来的版本和汉化后的版本：
before：
After：
测试&amp;调试
以上2，3步骤基本就是一个测试、调试的过程。
我开始先把所有配置项汉化。然后再处理选项参数。 接着build，重启grafana查看。如此往复达到预期目标。 我本机调试用docker启动grafana，测完删了容器就好了。
持续改进 考虑持续处理某个插件，可以考虑fork原插件项目，remote add XXX源。 然后新建分之来做自己的处理。master fetch XXX源 以跟踪上游的更新。 这样自己项目安装插件时候拉自己的就好啦，美滋滋。
...</p>
  </div>
  <footer class="entry-footer"><span title='2020-11-30 13:46:47 +0000 UTC'>2020-11-30</span></footer>
  <a class="entry-link" aria-label="post link to Grafana插件Plugin中文汉化" href="http://localhost:1313/aLong/posts/grafana%E6%8F%92%E4%BB%B6plugin%E4%B8%AD%E6%96%87%E6%B1%89%E5%8C%96/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">docker-compose编排搭建prometheus&#43;grafana&#43;alertmanager&#43;node-exporter&#43;snmp-exporter
    </h2>
  </header>
  <div class="entry-content">
    <p>Docker-compose 目前集成很多Exporter，加上grafana的image-renderer，后面又加上ping-exporter，很多东西加起来发现操作一次docker 很烦啊。
科普之后感觉自己对k8s还有有些发怵的。从简单的一个入手吧，选择了docker-compose。
Docker-Compose项目是Docker官方的开源项目，负责实现对Docker容器集群的快速编排。
安装 安装方式看了一下，我选择直接下载bin文件方式：
curl -L https://get.daocloud.io/docker/compose/releases/download/1.12.0/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose chmod &#43;x /usr/local/bin/docker-compose``` 通过 docker-compose version 看到版本信息算是安装完成。
编写docker-compose.yml 目录结构： ├── docker-compose.yaml ├── prometheus │ ├── rules │ │ └── *(rules).yaml/json │ ├── nodes │ │ └── *(nodes).yaml │ ├── data │ │ └── ... # 挂载prom的data数据 │ └── prometheus.yaml ├── alertmanager │ ├── templates │ │ └── *.tmpl │ └── alertmanager.yaml ├── grafana │ ├── data │ │ ├── plugins #插件目录 │ │ ├── png │ │ └── grafana.db │ └── grafana.ini ├── snmp(snmp_exporter) │ └── snmp.yml └── blackbox(balck box-exporter) └── blackbox.yml 根据结构编写
...</p>
  </div>
  <footer class="entry-footer"><span title='2020-11-17 13:02:50 +0000 UTC'>2020-11-17</span></footer>
  <a class="entry-link" aria-label="post link to docker-compose编排搭建prometheus&#43;grafana&#43;alertmanager&#43;node-exporter&#43;snmp-exporter" href="http://localhost:1313/aLong/posts/docker-compose%E7%BC%96%E6%8E%92%E6%90%AD%E5%BB%BAprometheus-grafana-alertmanager-node-exporter-snmp-exporter/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">关闭Mac的Microsoft AutoUpdate
    </h2>
  </header>
  <div class="entry-content">
    <p>最近使用Office 发现AutoUpdate一直会启动。我也不需要里面的更新。每次还要把它推出。
网上看到有两种方法，一种是暴力删除，另一种是通过权限限制。
暴力可不是我喜欢的方式，所以选择后者。
方法：
打开终端
cd /Library/Application\ Support/Microsoft/MAU2.0 sudo chmod 000 Microsoft\ AutoUpdate.app 两行命令后，输入密码就可以了。
</p>
  </div>
  <footer class="entry-footer"><span title='2020-10-13 13:14:34 +0000 UTC'>2020-10-13</span></footer>
  <a class="entry-link" aria-label="post link to 关闭Mac的Microsoft AutoUpdate" href="http://localhost:1313/aLong/posts/%E5%85%B3%E9%97%ADmac%E7%9A%84microsoft-autoupdate/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">申请Let&#39;s Encrypt HTTPS 证书脚本
    </h2>
  </header>
  <div class="entry-content">
    <p>最近需要到SSL证书，又想免懒。选择脚本来更新SSL证书文件 Let’s Encrypt是一个由非营利性组织互联网安全研究小组（ISRG）提供的免费、自动化和开放的证书颁发机构（CA）。 简单的说，借助Let’s Encrypt颁发的证书可以为我们的网站免费启用HTTPS(SSL/TLS) 。
那我们通过一个脚本来申请：
脚本名称： acme.sh
安装acme.sh： curl https://get.acme.sh | sh
创建指令： alias acme.sh=~/.acme.sh/acme.sh
测试收否安装成功： acme.sh --Version 出现版本，安装完成。
生成证书 acme.sh --issue -d demo.com -d www.demo.con -w /home/wwwroot/demo.com
–issue是acme.sh脚本用来颁发证书的指令； -d是–domain的简称，其后面须填写已备案的域名； -w是–webroot的简称，其后面须填写网站的根目录。
查看证书 acme.sh --list
Nginx 配置 项目是Nginx，下面是对Nginx的配置。
acme.sh –installcert -d demo.com –key-file /etc/nginx/ssl/demo.com.key –fullchain-file /etc/nginx/ssl/fullchain.cer –reloadcmd “service nginx force-reload”
通过 installcert 来完成安装，此处我们需要把*.key,fullchain.cer 文件拷贝到指定位置。最后通过reload命令让Nginx重载（force-reload 我环境中无法使用此参数，这里换成 restart）。
最后我们需要配置Nginx的443 server
server { listen 443 ssl; server_name demo.com; ssl on; ssl_certificate /etc/nginx/ssl/fullchain.cer; ssl_certificate_key /etc/nginx/ssl/esofar.cn.key; ... 到此基本上配置完成了。 Acme.sh 通过定时任务可以实现定期更新。 查看 crontab -l
...</p>
  </div>
  <footer class="entry-footer"><span title='2020-06-24 13:33:18 +0000 UTC'>2020-06-24</span></footer>
  <a class="entry-link" aria-label="post link to 申请Let&#39;s Encrypt HTTPS 证书脚本" href="http://localhost:1313/aLong/posts/%E7%94%B3%E8%AF%B7let-s-encrypt-https-%E8%AF%81%E4%B9%A6%E8%84%9A%E6%9C%AC/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">GORM 创建联合约束/索引
    </h2>
  </header>
  <div class="entry-content">
    <p>GROM创建联合索引 之前提到一个联合约束，那么根据需求再次做一个演示：
type Demo struct { ID uint `gorm:&#34;primary_key&#34;` CreatedAt time.Time UpdatedAt time.Time DeletedAt *time.Time `gorm:&#34;index;unique_index:name_d&#34;` Name string `gorm:&#34;unique_index:name_d&#34;` Status int } 通过demo 迁移后，deleted_at 与 name 会形成一个联合约束。
-OK,完结-
</p>
  </div>
  <footer class="entry-footer"><span title='2020-06-11 11:50:55 +0000 UTC'>2020-06-11</span></footer>
  <a class="entry-link" aria-label="post link to GORM 创建联合约束/索引" href="http://localhost:1313/aLong/posts/gorm-%E5%88%9B%E5%BB%BA%E8%81%94%E5%90%88%E7%BA%A6%E6%9D%9F-%E7%B4%A2%E5%BC%95/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">解决约束与软删除冲突
    </h2>
  </header>
  <div class="entry-content">
    <p>约束&amp;软删除冲突 本咸鱼对数据库方面研究甚少。能存数据就没多考虑其他问题。尤其是在设计方面。都是按照接口或者业务推到一下就好了。 这次考虑一个问题，学习了一个小问题的处理。 就是标题所述 约束与软删除的冲突。
场景问题例子：
一表单 字段为：
|:–| | id | | name | |… | | u_number | | deleted_at |
考虑 u_number 唯一问题，添加 约束 UNIQUE。 u_number 是可复用的一些唯一数据。
那么问题来了：
当操作软删除时候，deleted_at (类型 datetime) 填充删除时间后，我理想化数据已经被删除。当 u_number 被其他用户使用插入此表结果是失败的。
解决方式 u_number 因为唯一，导致后续使用此前删除的数据是不可行的，如果直接删前者数据也是不太有B格，不科学的事情。 通过 联合的约束来完善此事，deleted_at 正好是时间， 与其联合使用即解决此事。
约束不再是单一约束 u_number 修改成 u_number,deleted_at。
-OK，完结。-
</p>
  </div>
  <footer class="entry-footer"><span title='2020-06-11 11:15:55 +0000 UTC'>2020-06-11</span></footer>
  <a class="entry-link" aria-label="post link to 解决约束与软删除冲突" href="http://localhost:1313/aLong/posts/%E8%A7%A3%E5%86%B3%E7%BA%A6%E6%9D%9F-%E8%BD%AF%E5%88%A0%E9%99%A4%E5%86%B2%E7%AA%81/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Linux重启后Docker设置自动启动&amp;容器自动启动设置
    </h2>
  </header>
  <div class="entry-content">
    <p>Linux系统重启后Docker自动启动 系统重启后，如果docker没有启动，那么docker下所有的服务就都挂了。 配置过一次总是忘记命令，这里特意记录一下： systemctl enable docker.service
容器自动启动配置 容器配置好自动启动后，当docker运行后，容器也自动启动。这样能保证服务的稳定性。不用再登录到系统来操作各种容易启动问题。 涉及到的参数为： --restart=always
参数有：
no，默认策略，在容器退出时不重启容器
on-failure，在容器非正常退出时（退出状态非0），才会重启容器。例如：on-failure:3，在容器非正常退出时重启容器，最多重启3次
always，在容器退出时总是重启容器
unless-stopped，在容器退出时总是重启容器，但是不考虑在Docker守护进程启动时就已经停止了的容器
容器已存在更新重启配置 可能容器我们已经生成了，后面想实现always这个参数，可以用到下面的命令： docker container update --restart=always 容器名XXX 这样就达到了想要的目的。
</p>
  </div>
  <footer class="entry-footer"><span title='2020-05-18 11:03:48 +0000 UTC'>2020-05-18</span></footer>
  <a class="entry-link" aria-label="post link to Linux重启后Docker设置自动启动&容器自动启动设置" href="http://localhost:1313/aLong/posts/linux%E9%87%8D%E5%90%AF%E5%90%8Edocker%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E5%90%AF%E5%8A%A8-%E5%AE%B9%E5%99%A8%E8%87%AA%E5%8A%A8%E5%90%AF%E5%8A%A8%E8%AE%BE%E7%BD%AE/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">解决MAC软件提示已损坏或移到废纸篓
    </h2>
  </header>
  <div class="entry-content">
    <p>系统版本 macOS Catalina 10.15.1
方法一
允许任何来源的应用。
系统偏好设置 -&gt; 安全性和隐私： 在 允许从以下位置下载的应用程序 选项中选择 任何来源
在 Sierra 10.12 中可能看不到这个选项，开启此功能需要执行命令sudo spctl --master-disable,
输入密码就可以看到此选项。
方法二
如果上面发法还是打不开，可能需要此方法。
sudo xattr -r -d com.apple.quarantine /Applications/xxxx.app/
这里的x x.app如果你不知道名字，可以通过应用中查看应用简介中的名称与扩展名,
或者在Applications目录下输入名称补全
</p>
  </div>
  <footer class="entry-footer"><span title='2020-02-07 20:24:02 +0000 UTC'>2020-02-07</span></footer>
  <a class="entry-link" aria-label="post link to 解决MAC软件提示已损坏或移到废纸篓" href="http://localhost:1313/aLong/posts/%E8%A7%A3%E5%86%B3mac%E8%BD%AF%E4%BB%B6%E6%8F%90%E7%A4%BA%E5%B7%B2%E6%8D%9F%E5%9D%8F%E6%88%96%E7%A7%BB%E5%88%B0%E5%BA%9F%E7%BA%B8%E7%AF%93/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Mac book pro 终端走代理配置
    </h2>
  </header>
  <div class="entry-content">
    <p>mac 终端走ssr代理 前提是你已经知道怎么使用shadowsocks软件，并且可以出去之后。
看下自己ssr 代理端口号是多少 高级设置看下 本地Socks5监听端口 记住这个端口号。 后面： mac 现在默认终端是用的zsh 编辑 vi ～/.zshrc 在最后加入 //alias 后面的名字自己可以按照习惯定义， 比如我定义proxy 是 ss。 每当我需要时候 ss 一下就可以了。 不需要的时候执行第二句。
//端口按照你的来配置alias unproxy=&#39;unset all_proxy&#39; alias proxy=&#39;export all_proxy=socks5://127.0.0.1:1086&#39; 测试： 首先在没有走ss 的时候， curl cip.cc 得到一个国内的信息。 当使用ss之后， 再通过这个查询就可以看到变化了。
为了便捷，我觉得这个命令也可以设置成别名方式。
设置一个where 每次当我迷茫不知道自己出没出去的时候，就可以 输入where 看下。 alias where=&#39;curl cip.cc&#39;
</p>
  </div>
  <footer class="entry-footer"><span title='2020-01-20 08:13:10 +0000 UTC'>2020-01-20</span></footer>
  <a class="entry-link" aria-label="post link to Mac book pro 终端走代理配置" href="http://localhost:1313/aLong/posts/mac-book-pro-%E7%BB%88%E7%AB%AF%E8%B5%B0%E4%BB%A3%E7%90%86%E9%85%8D%E7%BD%AE/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="http://localhost:1313/aLong/page/2/">
      «&nbsp;Prev&nbsp;
    </a>
    <a class="next" href="http://localhost:1313/aLong/page/4/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    <footer>
    // ... 其他页脚内容 ...
    <a href="http://localhost:1313/aLong/index.xml">订阅RSS</a>
</footer></body>

</html>