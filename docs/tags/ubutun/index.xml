<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ubutun on aLong blog</title>
    <link>http://localhost:1313/aLong/tags/ubutun/</link>
    <description>Recent content in Ubutun on aLong blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 11 Jan 2023 16:30:47 +0800</lastBuildDate><atom:link href="http://localhost:1313/aLong/tags/ubutun/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Ubuntu22.04安装kubeadm</title>
      <link>http://localhost:1313/aLong/posts/ubuntu22.04%E5%AE%89%E8%A3%85kubeadm/</link>
      <pubDate>Wed, 11 Jan 2023 16:30:47 +0800</pubDate>
      
      <guid>http://localhost:1313/aLong/posts/ubuntu22.04%E5%AE%89%E8%A3%85kubeadm/</guid>
      <description>&lt;h1 id=&#34;学习k8s&#34;&gt;学习k8s&lt;/h1&gt;
&lt;p&gt;学习k8s做笔记，通过kubeadm搭建1master、2node。网络插件：flannel。系统Ubuntu22.04&lt;/p&gt;
&lt;h2 id=&#34;系统安装docker&#34;&gt;系统安装docker&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.docker.com/engine/install/ubuntu/&#34;&gt;Docker官方手册&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;master、node设备各安装docker、kubelet、 kubeadm、 kubectl。&lt;/p&gt;
&lt;h2 id=&#34;为kubeadm准备&#34;&gt;为kubeadm准备&lt;/h2&gt;
&lt;p&gt;master、node进行准备工作：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;将cgroup处理改成systemd&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;nano /etc/docker/daemon.json&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;&amp;#34;exec-opts&amp;#34;&lt;/span&gt;: [&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;native.cgroupdriver=systemd&amp;#34;&lt;/span&gt;],
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;&amp;#34;log-driver&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;json-file&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;&amp;#34;log-opts&amp;#34;&lt;/span&gt;: {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;&amp;#34;max-size&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;100m&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  },
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;&amp;#34;storage-driver&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;overlay2&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;sudo systemctl enable docker&lt;/code&gt;
&lt;code&gt;sudo systemctl daemon-reload&lt;/code&gt;
&lt;code&gt;sudo systemctl restart docker&lt;/code&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;为了让 Kubernetes 能够检查、转发网络流量，你需要修改 iptables 的配置，启用“br_netfilter”模块&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;nano /etc/modules-load.d/k8s.conf&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-ini&#34; data-lang=&#34;ini&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7d9029&#34;&gt;br_netfilter&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;nano /etc/sysctl.d/k8s.conf&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-ini&#34; data-lang=&#34;ini&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7d9029&#34;&gt;net.bridge.bridge-nf-call-ip6tables&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7d9029&#34;&gt;net.bridge.bridge-nf-call-iptables&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7d9029&#34;&gt;net.ipv4.ip_forward&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;sudo sysctl --system&lt;/code&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;修改“/etc/fstab”，关闭 Linux 的 swap 分区，提升 Kubernetes 的性能&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-ini&#34; data-lang=&#34;ini&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7d9029&#34;&gt;sudo swapoff -a&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#7d9029&#34;&gt;sudo sed -ri &amp;#39;/\sswap\s/s/^#?/#/&amp;#39; /etc/fstab&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;安装kubeadm&#34;&gt;安装kubeadm&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/&#34;&gt;Kuneadm官方手册&lt;/a&gt;
&lt;strong&gt;在master、node上都需要安装&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;更新 &lt;code&gt;apt&lt;/code&gt; 包索引并安装使用 Kubernetes &lt;code&gt;apt&lt;/code&gt; 仓库所需要的包：&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt-get update
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo apt-get install -y apt-transport-https ca-certificates curl
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;(有条件)下载 Google Cloud 公开签名秘钥：&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sudo curl -fsSLo /etc/apt/keyrings/kubernetes-archive-keyring.gpg https://packages.cloud.google.com/apt/doc/apt-key.gpg
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;如果上面访问不到，可选择其他,例如&lt;a href=&#34;https://mirrors.tuna.tsinghua.edu.cn/help/kubernetes/&#34;&gt;清华源&lt;/a&gt;提供：
导入gpg key&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Ubutun16.04安装Python</title>
      <link>http://localhost:1313/aLong/posts/ubutun16-04%E5%AE%89%E8%A3%85python/</link>
      <pubDate>Fri, 24 May 2019 11:17:59 +0000</pubDate>
      
      <guid>http://localhost:1313/aLong/posts/ubutun16-04%E5%AE%89%E8%A3%85python/</guid>
      <description>&lt;h3 id=&#34;目的&#34;&gt;目的&lt;/h3&gt;
&lt;p&gt;安装python3.7.3
安装pip&lt;/p&gt;
&lt;h3 id=&#34;准备工作&#34;&gt;准备工作&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;系统内置python2.X,去除默认python的软链, &lt;code&gt;sudo rm /usr/bin/python&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;安装一些软件包&amp;amp;软件包保持最新状态.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;sudo apt-get update&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo apt-get install build-essential zlib1g-dev libncurses5-dev libgdbm-dev libnss3-dev libssl-dev libreadline-dev libffi-dev wget&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;安装python&#34;&gt;安装Python&lt;/h3&gt;
&lt;p&gt;通过编译安装python&lt;/p&gt;
&lt;p&gt;默认我下载在home里, &lt;code&gt;cd&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;下载新python文件, &lt;code&gt;wget https://www.python.org/ftp/python/3.7.3/Python-3.7.3.tgz &lt;/code&gt;&lt;/p&gt;
&lt;p&gt;解压文件, &lt;code&gt;tar zxf Python-3.7.3.tgz&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;把这个文件拷贝到放置的位置. 这里我放到/usr/local/python &lt;code&gt;mkdir -p /usr/local/python&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;进入这个目录, 执行 &lt;code&gt;./configure --enable-optimizations&lt;/code&gt;
之后执行 &lt;code&gt;sudo make -j 8&lt;/code&gt;  这里8根据设备cpu核心数来的,不知道你可以写1(手动滑稽)&lt;/p&gt;
&lt;p&gt;make之后 该 &lt;del&gt;make install&lt;/del&gt; 嘛? NO! 是 &lt;code&gt;sudo make altinstall&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;装完之后, 可以尝试 python &amp;ndash;version 看看有没有, 如果没有或者版本不对.可能是准备里你没有删除 /usr/bin/python 或者这个不存在.
需要手动添加一下,我这个是没有给我创建成功.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo ln -s /usr/local/Python-3.7.3/python /usr/bin/python&lt;/code&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Ubutun下安装Docker</title>
      <link>http://localhost:1313/aLong/posts/ubutun%E4%B8%8B%E5%AE%89%E8%A3%85docker/</link>
      <pubDate>Thu, 04 Apr 2019 14:57:16 +0000</pubDate>
      
      <guid>http://localhost:1313/aLong/posts/ubutun%E4%B8%8B%E5%AE%89%E8%A3%85docker/</guid>
      <description>&lt;h3 id=&#34;docker简介&#34;&gt;Docker简介&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;一个能够把开发的应用程序自动部署到容器的开源引擎
三大概念：镜像（Image）容器（Container）仓库（Repository）&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;具体信息请参考官方。&lt;a href=&#34;https://docs.docker.com/engine/docker-overview/&#34;&gt;官方概述&lt;/a&gt;（养成看文档习惯）&lt;/p&gt;
&lt;h3 id=&#34;安装环境&#34;&gt;安装环境&lt;/h3&gt;
&lt;p&gt;Ubuntu 16.04 LTS&lt;/p&gt;
&lt;h3 id=&#34;docker安装&#34;&gt;Docker安装&lt;/h3&gt;
&lt;p&gt;根据官方doc安装。&lt;a href=&#34;https://docs.docker.com/install/linux/docker-ce/ubuntu/&#34;&gt;官方doc&lt;/a&gt;
1.如果你之前装过，命令卸载。
&lt;code&gt;sudo apt-get remove docker docker-engine docker.io containerd runc&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2.更新包索引
&lt;code&gt;apt-get update&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;3.安装包以允许apt通过HTTPS使用存储库:
&lt;code&gt;sudo apt-get install \ apt-transport-https \ ca-certificates \ curl \ gnupg-agent \ software-properties-common&lt;/code&gt;
（斜线换行，一条命令）&lt;/p&gt;
&lt;p&gt;4.添加Docker的官方GPG密钥:
&lt;code&gt;curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -&lt;/code&gt;
&lt;code&gt;sudo apt-key fingerprint 0EBFCD88&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;5.使用以下命令设置稳定存储库。要添加 夜间或测试存储库，请在下面的命令中的单词后添加单词nightly或test（或两者）stable。
&lt;code&gt;$ sudo add-apt-repository \ &amp;quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \ $(lsb_release -cs) \ stable&amp;quot;&lt;/code&gt;
(lsb_release -cs子命令返回Ubuntu发行版的名称)&lt;/p&gt;
&lt;p&gt;6.安装最新版本的Docker CE和containerd，或者转到下一步安装特定版本：
&lt;code&gt;sudo apt-get install docker-ce docker-ce-cli containerd.io&lt;/code&gt;&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>
